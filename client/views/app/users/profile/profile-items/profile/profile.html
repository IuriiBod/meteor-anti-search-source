<template name="profile">
  <div class="col-sm-12 col-md-6 col-lg-4">
    <div class="ibox float-e-margins">
      <div class="ibox-title">
        <h5>Profile Detail</h5>
      </div>
      <div>
        {{> profileImage user}}
        <div class="ibox-content profile-content">
          <h4>
            <strong>
              {{#if isEditPermitted}}
                <a href="" id="firstname">{{firstName}}</a>
                <a href="" id="lastname">{{lastName}}</a>
              {{else}}
                {{username user._id}}
              {{/if}}
            </strong>
          </h4>

          <p><i class="fa fa-mobile-phone m-r-xs"></i>
            {{#if isEditPermitted}}
              <a href="#" id="phone" data-id="{{user._id}}" class="editable">{{user.profile.phone}}</a>
            {{else}}
              {{user.profile.phone}}
            {{/if}}
          </p>

          <p><i class="fa fa-envelope m-r-xs"></i>
            {{#if isEditPermitted}}
              <a href="#" id="email" data-id="{{user._id}}" class="editable">{{email}}</a>
            {{else}}
              {{email}}
            {{/if}}
          </p>
          <br>

          <form id="change-pin">
            <div class="form-group">
              <label for="new-pin">New PIN</label>
              <input type="password"
                     class="form-control"
                     placeholder="****"
                     required=""
                     id="new-pin"
                     maxlength="4"
                     pattern="^\d{4}$"
                     title="Required four-digit PIN.">
            </div>
            <button type="submit" class="btn btn-default">Submit</button>
          </form>
          <br>

          <form id="change-password">
              <div class="form-group">
                  <label for="old-password">Old password</label>
                  <input type="password"
                         class="form-control"
                         placeholder="******"
                         required
                         id="old-password" >
              </div>
              <div class="form-group">
                  <label for="new-password">New password</label>
                  <input type="password"
                         class="form-control"
                         placeholder="Password"
                         required
                         pattern="^[a-zA-Z0-9]\w{3,14}$"
                         title="From 3 to 14 characters."
                         id="new-password" >
              </div>
              <div class="form-group">
                  <input type="password"
                         class="form-control"
                         placeholder="Confirm"
                         required
                         id="confirm-password" >
              </div>
              <button type="submit" class="btn btn-default">Submit</button>
          </form>
          <br>

          <h4>Pay rates</h4>

          <p>Weekdays ($):
            {{#if isManager}}
              <a href="#" id="weekdaysrate" data-id="{{user._id}}"
                 class="editable">{{user.profile.payrates.weekdays}}</a>
            {{else}}
              {{#if user.profile.payrates.weekdays}}
                {{user.profile.payrates.weekdays}}
              {{else}}
                Not added
              {{/if}}
            {{/if}}
          </p>

          <p>Saturday ($):
            {{#if isManager}}
              <a href="#" id="saturdayrate" data-id="{{user._id}}"
                 class="editable">{{user.profile.payrates.saturday}}</a>
            {{else}}
              {{#if user.profile.payrates.saturday}}
                {{user.profile.payrates.saturday}}
              {{else}}
                Not added
              {{/if}}
            {{/if}}
          </p>

          <p>Sunday ($):
            {{#if isManager}}
              <a href="#" id="sundayrate" data-id="{{user._id}}"
                 class="editable">{{user.profile.payrates.sunday}}</a>
            {{else}}
              {{#if user.profile.payrates.sunday}}
                {{user.profile.payrates.sunday}}
              {{else}}
                Not added
              {{/if}}
            {{/if}}
          </p>
          <br>
          <br>

          <h4>No. of shifts per week</h4>
          {{#if isManager}}
            <select class="form-control shiftsPerWeek" data-id="{{user._id}}">
              {{#each shiftsPerWeek}}
                <option selected="{{user.selected}}">{{user.shift}}</option>
              {{/each}}
            </select>
          {{else}}
            {{#if user.profile.shiftsPerWeek}}
              {{user.profile.shiftsPerWeek}}
            {{else}}
              Not added
            {{/if}}
          {{/if}}

          {{#if isManager}}
            {{#if isMe state$id}}
              {{#if hasResignDate}}
                <br/>
                <h4>Resigned date</h4>

                <div>
                  {{resignDate}}
                </div>
              {{/if}}
            {{else}}
              <br/>
              <h4>Resigned date</h4>

              <div class="input-group">
                <input type="text"
                       class="form-control open-resigned-date-picker"
                       placeholder="No resign date"
                       aria-describedby="user-resign-addon"
                       value="{{resignDate}}">

                  <span class="input-group-btn">
                    {{#if hasResignDate}}
                      <button class="btn btn-warning" id="update-resign-date">
                        <i class="fa fa-user-times"></i>
                        Update Date
                      </button>
                      <button class="btn btn-info" id="remove-resign-date">
                        <i class="fa fa-user"></i>
                        Restore User
                      </button>
                    {{else}}
                      <button class="btn btn-danger" id="set-resign-date">
                        <i class="fa fa-user-times"></i>
                        Resign User
                      </button>
                    {{/if}}
                  </span>
              </div>
            {{/if}}
          {{else}}
            {{#if hasResignDate}}
              <br/>
              <h4>Resigned date</h4>

              <div>
                {{resignDate}}
              </div>
            {{/if}}
          {{/if}}

          <h4>Last login: {{lastLoginDate}}</h4>
        </div>
      </div>
    </div>
  </div>
</template>
