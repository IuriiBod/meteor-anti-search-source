<template name="stocktakeCounting">
  <!-- Page heading -->
  {{> pageHeading title='Stocktake Counting' category="Stocktake List"}}

  <div class="wrapper wrapper-content stocktake-counting">
    <div class="row">
      <div class="col-lg-2 col-md-3 date-and-cost">
        {{dateFormat date}}: ${{roundCount totalStocktakeCost}}
      </div>
      <div class="col-lg-10 col-md-9">
        <div class="row">
          <div class="col-lg-1"></div>
          <div class="col-lg-11 col-md-12 controls-block">
            <div class="suppliers-filter">
              {{> suppliersFilter onSupplierIdChanged=onSupplierIdChanged}}
            </div>
            {{#if hasOrders}}
              <a class="btn btn-primary btn-sm" href="{{pathFor route='stocktakeOrdering'}}">
                View Orders
              </a>
            {{else}}
              {{#if isEditMode}}
                <a class="btn btn-link btn-sm finish-template-editing-button"><i class="fa fa-fw fa-save"></i>Finish Template Editing</a>
              {{else}}
                <a class="btn btn-link btn-sm edit-template-button"><i class="fa fa-fw fa-edit"></i>Edit Stocktake Template</a>
              {{/if}}
                <a class="btn btn-primary btn-sm generate-orders-button">Save stocktake &amp; generate orders</a>
                {{#if isEmpty}}
                  <a class="btn btn-danger btn-sm remove-stocktake-button">
                    <i class="fa fa-trash-o" aria-hidden="true"></i> Remove stocktake
                  </a>
                {{/if}}
            {{/if}}
          </div>
        </div>
      </div>
      <hr>
    </div>

    <div class="row">
      {{> stockAreasFilter onStockAreaSelect=onStockAreaSelect activeAreas=activeAreas isEditMode=isEditMode}}
      <div class="col-md-8">
        {{#if activeAreas.special}}
          <div class="tabs-container">
            <ul class="nav nav-tabs">
              <li role="presentation" class="{{#if isStockItemsShowing}}active{{/if}}">
                <a href="#" class="show-stock-items">Stock Items</a>
              </li>
              <li role="presentation" class="{{#unless isStockItemsShowing}}active{{/unless}}">
                <a href="#" class="show-prep-stock-items">Prep Items</a>
              </li>
            </ul>
            <div class="tab-content">
              <div class="panel-body no-top-border">
                {{#if isStockItemsShowing}}
                  {{> stockItemsList stocktakeId=_id specialAreaId=activeAreas.special isEditMode=isEditMode supplierId=supplierId}}
                {{else}}
                  {{> stockPrepItemsList stocktakeId=_id specialAreaId=activeAreas.special isEditMode=isEditMode}}
                {{/if}}

                {{#if isEditMode}}
                  <a class="btn btn-block btn-default btn-outline add-item-button">
                    Add {{#if isStockItemsShowing}}stock{{else}}prep{{/if}} items to this area
                  </a>
                {{/if}}
              </div>
            </div>
          </div>
        {{else}}
          Select areas to show list of stock items
        {{/if}}
      </div>
    </div>
  </div>
</template>