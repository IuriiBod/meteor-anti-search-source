<template name="stockCountingList">
  <div class="row">
    <div class="col-lg-12">
      {{#if notTemplate}}
        <a class="btn btn-primary btn-sm pull-right" href="{{pathFor route='stocktakeOrdering' _id=stocktakeId}}">View Orders</a>
      {{else}}
        <a class="btn btn-primary btn-sm pull-right generateOrders">Save stocktake &amp; generate orders</a>
        {{#if stockTakeCountingContext.editableStockTake}}
          <a class="btn btn-link btn-sm pull-right saveStockTake"><i class="fa fa-fw fa-save"></i>Save</a>
        {{else}}
          <a class="btn btn-link btn-sm pull-right editStockTake"><i class="fa fa-fw fa-edit"></i>Edit Stocktake
            Template</a>
        {{/if}}
      {{/if}}
      {{dateFormat stockTakeMain.stocktakeDate}}
      <hr>
    </div>
  </div>
  
  <div class="row">
    {{> stocktakeAreaFilter stockTakeData=stockTakeCountingContext}}
    {{#if stockTakeCountingContext.activeSpecialArea}}
      <div class="col-md-8">
        {{#if notTemplate}}
          <ul class="list-group">
            {{#each stocktakeList}}
              {{> stockCountingListItem stocktakeItem=this stockTakeData=stockTakeCountingContext}}
            {{else}}
              No items on this list
            {{/each}}
          </ul>
        {{else}}
          {{#if stockTakeCountingContext.editableStockTake}}
            {{> stockItemsListSortable ingredientsList=ingredientsList stockTakeData=stockTakeCountingContext}}
            <a class="btn btn-block btn-default btn-outline addStock">Add stock items to this area</a>
          {{else}}
            <ul class="list-group">
              {{#each ingredientsList}}
                {{> stockCountingListItem ingredientId=this._id stockTakeData=stockTakeCountingContext}}
              {{else}}
                No items on this list
              {{/each}}
            </ul>
          {{/if}}
        {{/if}}
      </div>
    {{else}}
      Select areas to show list of stock items
    {{/if}}
  </div>

  {{#if stockTakeCountingContext.activeSpecialArea}}
  <div class="modal fade" id="stocksListModal" tabindex="-1" role="dialog" aria-labelledby="stockslistModal"
       aria-hidden="true">
    {{> stocksModalList name="stockModal" modalStockListParams=modalStockListParams}}
  </div>
  {{/if}}

  <div class="modal fade" id="addNewGeneralAreaModal" tabindex="-1" role="dialog" aria-labelledby="areasModal"
       aria-hidden="true">
    {{> newAreaModal name="general"}}
  </div>

  <div class="modal fade" id="addNewSpecialAreaModal" tabindex="-1" role="dialog" aria-labelledby="areasModal"
       aria-hidden="true">
    {{> newAreaModal name="special" generalArea=stockTakeCountingContext.activeGeneralArea}}
  </div>
</template>