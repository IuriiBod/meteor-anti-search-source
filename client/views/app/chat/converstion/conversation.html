<template name="conversation">
  <div class="conversation">
    <div class="flyout-header">
        {{> CloseFlyoutButton}}
      <ul class="list-inline">
          {{#unless isParticipantsListOpened}}
            <li><a class="add-participant" href="#"><i class="fa fa-user-plus"></i></a></li>
          {{/unless}}
        <li class="dropdown">
          <a href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <i class="fa fa-ellipsis-h"></i>
          </a>
          <ul class="dropdown-menu pull-right">
            <li><a class="leave-conversation" href="#">Leave conversation</a></li>
          </ul>
        </li>
          {{#if countOfNotRead}}
            <li>
              <a class="count-info">
                <i class="fa fa-envelope"></i>
                <span class="label label-primary">{{countOfNotRead}}</span>
              </a>
            </li>
          {{/if}}
      </ul>
      <div class="conversation-title-wrapper">
          {{#if isParticipantsListOpened}}
            Invite participants
          {{else}}
              {{participantsListStr}}
          {{/if}}
        <br>
        <a href="#"
           class="subject-of-conversation"
           data-type="text"
           data-name="username"
           data-original-title="Enter username">{{subjectOfConversation}}</a>
      </div>
    </div>


    <div class="flyout-content">
        <div class="chat-discussion">
            {{#each messages}}
                {{> conversationMessage }}
            {{/each}}
        </div>
        <form class="chat-message-form">
            <img class="message-sender-avatar" src="{{profilePicture userId}}" alt="">
            {{#textareaAutocomplete settings=textAreaAutocompleteSettings name="message" class='form-control message-area' placeholder='Enter your message'}}
            {{/textareaAutocomplete}}
        </form>
      <div class="inner-flyout  {{#if isParticipantsListOpened}}show-inner-flyout{{else}}hide-inner-flyout{{/if}}
          {{#if isInnerFlyoutAnimated}}with-animation{{/if}}">
          {{> participantsList conversationId=conversation._id onCloseFlyout=hideParticipantsList}}
      </div>
    </div>
  </div>
</template>